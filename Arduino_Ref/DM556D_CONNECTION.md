# Підключення драйвера DM556D до Arduino

## ⚠️ ВАЖЛИВО: STEP та DIR - це НЕ живлення!

**STEP** та **DIR** - це **цифрові сигнали** (логічні входи), а НЕ плюс/мінус!

---

## 🔌 Правильне підключення DM556D

### 1. Цифрові сигнали (STEP+/STEP- та DIR+/DIR-)

**Якщо на драйвері є STEP+/STEP- та DIR+/DIR- (диференційні входи):**

```
DM556D              Arduino
─────────────────────────────────
STEP+        →      Pin 6 (OUTPUT)
STEP-        →      GND (земля)
DIR+         →      Pin 7 (OUTPUT)
DIR-         →      GND (земля)
GND          →      GND (спільна земля!)
```

**Важливо:**
- ✅ **STEP+** підключається до **цифрового піна 6** (OUTPUT)
- ✅ **STEP-** підключається до **GND** (земля)
- ✅ **DIR+** підключається до **цифрового піна 7** (OUTPUT)
- ✅ **DIR-** підключається до **GND** (земля)
- ✅ **GND DM556D** підключається до **GND Arduino** (обов'язково!)
- ❌ STEP+ та DIR+ НЕ підключаються до 5V або GND напряму!
- ❌ STEP- та DIR- НЕ підключаються до цифрових пінів!

**Примітка:** Диференційні входи (STEP+/STEP-, DIR+/DIR-) використовуються для ізоляції через оптопари всередині драйвера.

---

### 2. Логічне живлення DM556D

```
DM556D              Arduino/Джерело живлення
─────────────────────────────────────────────
VCC          →      5V (логічне живлення)
GND          →      GND (спільна земля)
```

**Примітка:**
- VCC - це логічне живлення для мікросхеми драйвера (5V)
- Може бути від Arduino 5V або окремого джерела 5V
- GND має бути спільним з Arduino GND

---

### 3. Живлення двигуна (VM+ та VM-)

```
DM556D              Блок живлення двигуна
───────────────────────────────────────────
VM+          →      +12V до +24V (позитив)
VM-          →      GND (мінус)
```

**Важливо:**
- VM+/VM- - це живлення для **крокового двигуна** (12-24V)
- **НЕ підключайте VM+ до Arduino!** Це окреме живлення!
- GND від блоку живлення двигуна має бути з'єднаний з GND Arduino

---

## 📋 Повна схема підключення

### Варіант 1: Диференційні входи (STEP+/STEP-, DIR+/DIR-)

```
┌─────────────────┐
│   Arduino       │
│                 │
│  Pin 6 (OUT) ───┼──→ DM556D STEP+
│  Pin 7 (OUT) ───┼──→ DM556D DIR+
│  GND ───────────┼──→ DM556D STEP-
│  GND ───────────┼──→ DM556D DIR-
│  GND ───────────┼──→ DM556D GND
│  5V ────────────┼──→ DM556D VCC (логічне)
└─────────────────┘
```

### Варіант 2: Одиночні входи (STEP, DIR) - якщо немає +/- пінів

```
┌─────────────────┐
│   Arduino       │
│                 │
│  Pin 6 (OUT) ───┼──→ DM556D STEP
│  Pin 7 (OUT) ───┼──→ DM556D DIR
│  GND ───────────┼──→ DM556D GND
│  5V ────────────┼──→ DM556D VCC (логічне)
└─────────────────┘
```

┌─────────────────┐
│  Блок живлення  │
│  12-24V DC      │
│                 │
│  + ─────────────┼──→ DM556D VM+ (живлення двигуна)
│  - ─────────────┼──→ DM556D VM- (GND двигуна)
│                 │
│  - ─────────────┼──→ GND (спільна з Arduino)
└─────────────────┘

┌─────────────────┐
│   DM556D        │
│                 │
│  STEP ← Pin 6   │
│  DIR  ← Pin 7   │
│  GND  ← GND     │
│  VCC  ← 5V      │
│  VM+  ← +12-24V │
│  VM-  ← GND     │
│                 │
│  A+ ────────────┼──→ Кроковий двигун (фаза A+)
│  A- ────────────┼──→ Кроковий двигун (фаза A-)
│  B+ ────────────┼──→ Кроковий двигун (фаза B+)
│  B- ────────────┼──→ Кроковий двигун (фаза B-)
└─────────────────┘
```

---

## ✅ Правильна послідовність підключення

### Крок 1: Підключення сигналів
1. **STEP+** → Arduino Pin 6 (OUTPUT)
2. **STEP-** → Arduino GND (земля)
3. **DIR+** → Arduino Pin 7 (OUTPUT)
4. **DIR-** → Arduino GND (земля)
5. **GND** → Arduino GND (обов'язково - спільна земля!)

### Крок 2: Логічне живлення
4. **VCC** → Arduino 5V (або окреме джерело 5V)

### Крок 3: Живлення двигуна
5. **VM+** → +12V до +24V (окреме джерело!)
6. **VM-** → GND (з'єднати з GND Arduino)

### Крок 4: Підключення двигуна
7. **A+, A-, B+, B-** → відповідні фази крокового двигуна

---

## ⚠️ Типові помилки

### ❌ НЕПРАВИЛЬНО:
```
STEP+ → 5V (плюс)       ❌ НЕПРАВИЛЬНО!
STEP- → Pin 6           ❌ НЕПРАВИЛЬНО!
DIR+  → GND (мінус)     ❌ НЕПРАВИЛЬНО!
DIR-  → Pin 7           ❌ НЕПРАВИЛЬНО!
```

### ✅ ПРАВИЛЬНО:
```
STEP+ → Pin 6 (OUTPUT)  ✅ ПРАВИЛЬНО!
STEP- → GND (земля)    ✅ ПРАВИЛЬНО!
DIR+  → Pin 7 (OUTPUT)  ✅ ПРАВИЛЬНО!
DIR-  → GND (земля)     ✅ ПРАВИЛЬНО!
GND   → GND (спільна)   ✅ ПРАВИЛЬНО!
```

---

## 🔍 Як працюють сигнали

### STEP+/STEP- (пін 6)
- **STEP+ = HIGH (5V), STEP- = LOW (0V)** → формує імпульс для кроку
- **STEP+ = LOW (0V), STEP- = LOW (0V)** → відсутність імпульсу
- Arduino генерує імпульси на STEP+: HIGH → LOW → HIGH → LOW...
- STEP- завжди підключений до GND

### DIR+/DIR- (пін 7)
- **DIR+ = HIGH (5V), DIR- = LOW (0V)** → напрямок руху в одну сторону
- **DIR+ = LOW (0V), DIR- = LOW (0V)** → напрямок руху в іншу сторону
- Встановлюється перед початком руху
- DIR- завжди підключений до GND

**Примітка:** Диференційні входи (STEP+/STEP-, DIR+/DIR-) забезпечують ізоляцію через оптопари всередині драйвера.

---

## 📊 Таблиця підключення

| Пін DM556D | Підключення | Тип | Напруга | Примітка |
|------------|-------------|-----|---------|----------|
| **STEP+** | Arduino Pin 6 | Цифровий сигнал | 0V / 5V (логіка) | Позитивний сигнал |
| **STEP-** | Arduino GND | Земля | 0V | Негативний сигнал (завжди GND) |
| **DIR+** | Arduino Pin 7 | Цифровий сигнал | 0V / 5V (логіка) | Позитивний сигнал |
| **DIR-** | Arduino GND | Земля | 0V | Негативний сигнал (завжди GND) |
| **GND** | Arduino GND | Земля | 0V | Спільна земля (обов'язково!) |
| **VCC** | Arduino 5V | Логічне живлення | 5V | Живлення мікросхеми |
| **VM+** | Блок живлення + | Живлення двигуна | +12V до +24V | Окреме джерело! |
| **VM-** | Блок живлення - | Земля двигуна | 0V | З'єднати з GND Arduino |
| **ENA** | GND (опціонально) | Enable | 0V | Завжди ввімкнений |

---

## 🔧 Додаткові налаштування DM556D

### Пін ENA (Enable)
- Можна залишити непідключеним (внутрішня підтяжка)
- Або підключити до GND для постійного ввімкнення
- Якщо підключити до 5V - драйвер вимкнеться

### Мікростепи
- Налаштування на самому драйвері DM556D
- В нашому проекті: **16 мікростепів** (за config.h)
- Перевірте діп-перемикачі на платі DM556D

---

## ⚡ Безпека

1. ✅ **Завжди** підключайте GND першим
2. ✅ Перевіряйте полярність VM+/VM- перед підключенням
3. ✅ Не підключайте VM+ до Arduino (може пошкодити!)
4. ✅ Використовуйте окреме живлення для двигуна
5. ✅ Перевіряйте напругу живлення двигуна (12-24V)

---

## 🧪 Тестування

### Перевірка підключення:

1. **Перевірка сигналів:**
   - Підключіть мультиметр до STEP та GND
   - Запустіть скетч
   - Має бути зміна напруги 0V ↔ 5V

2. **Перевірка DIR:**
   - Підключіть мультиметр до DIR та GND
   - Змініть напрямок в коді
   - Напруга має змінюватися 0V ↔ 5V

3. **Перевірка живлення:**
   - VM+ має мати 12-24V (залежно від блоку)
   - VCC має мати 5V
   - GND має бути 0V

---

## 📝 Підсумок

**STEP+/STEP- та DIR+/DIR-:**
- ✅ **STEP+** → Arduino Pin 6 (OUTPUT) - позитивний сигнал
- ✅ **STEP-** → Arduino GND - негативний сигнал (завжди GND)
- ✅ **DIR+** → Arduino Pin 7 (OUTPUT) - позитивний сигнал
- ✅ **DIR-** → Arduino GND - негативний сигнал (завжди GND)
- ✅ Це **сигнали**, а не живлення
- ✅ GND має бути **спільним** між всіма компонентами

**Живлення:**
- ✅ VCC → 5V (логічне живлення драйвера)
- ✅ VM+ → 12-24V (живлення двигуна, окреме джерело!)
- ✅ VM- → GND (спільна з Arduino)

---

## 🎯 Швидка відповідь

**Що підключаємо до Arduino:**
- ✅ STEP+ → Pin 6
- ✅ DIR+ → Pin 7
- ✅ STEP- → GND
- ✅ DIR- → GND
- ✅ GND → GND

**Що з'єднуємо до купи (GND):**
- ✅ STEP- → GND
- ✅ DIR- → GND
- ✅ GND драйвера → GND
- ✅ VM- → GND

**Головне правило:** 
- **STEP+ та DIR+** - це сигнали управління, підключаються до цифрових пінів
- **STEP- та DIR-** - це негативні входи, завжди підключаються до GND
